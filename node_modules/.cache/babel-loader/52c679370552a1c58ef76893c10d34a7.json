{"ast":null,"code":"import _objectSpread from \"/home/caio/workspace/wp/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport _slicedToArray from \"/home/caio/workspace/wp/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/home/caio/workspace/wp/src/compopnents/App.jsx\";\nimport React from \"react\";\nimport \"../styles/App.css\";\nimport LeafletMap from \"./LeafletMap\";\nimport RouterPanel from \"./RouterPanel\";\nimport SimulationOptions from \"./SimulationOptions\";\nimport { MDBIcon } from \"mdbreact\";\nimport routers from \"../routersList\";\nimport { clone } from \"../utils\";\n\nconst App = () => {\n  const patrolInitialPosition = {\n    status: true,\n    lat: 43.5387,\n    lng: -79.666,\n    direction: 0,\n    //   0->east, 1->north, 2->weast, 3->south\n    step: 14\n  };\n  const intruderInitialPosition = {\n    name: \"PDSB-ADMIN\",\n    status: false,\n    lat: 43.5392,\n    lng: -79.6675,\n    direction: 2,\n    //   0->east, 1->north, 2->weast, 3->south\n    step: 14\n  };\n  const center = [43.53885796212106, -79.66675600122652];\n\n  const stepCounter = target => {\n    let stepCounter = target.step;\n    let patrolDirection = target.direction;\n\n    if (stepCounter > 0) {\n      stepCounter = stepCounter - 1;\n      return {\n        step: stepCounter,\n        direction: patrolDirection\n      };\n    } else {\n      patrolDirection = patrolDirection + 1;\n\n      if (patrolDirection % 2 === 0) {\n        // Mississauga is way too North, I had to adjust\n        stepCounter = 14; // the step because lat!=lgn near the polos\n      } else {\n        stepCounter = 5; // Just 5 steps when walking on vertical.\n      }\n\n      return {\n        step: stepCounter,\n        direction: patrolDirection\n      };\n    }\n  };\n\n  const _React$useState = React.useState(true),\n        _React$useState2 = _slicedToArray(_React$useState, 2),\n        showSimulationOptions = _React$useState2[0],\n        setShowSimulationOptions = _React$useState2[1];\n\n  const _React$useState3 = React.useState(patrolInitialPosition),\n        _React$useState4 = _slicedToArray(_React$useState3, 2),\n        patrol = _React$useState4[0],\n        setPatrol = _React$useState4[1];\n\n  const _React$useState5 = React.useState(intruderInitialPosition),\n        _React$useState6 = _slicedToArray(_React$useState5, 2),\n        intruder = _React$useState6[0],\n        setIntruder = _React$useState6[1];\n\n  const _React$useState7 = React.useState(false),\n        _React$useState8 = _slicedToArray(_React$useState7, 2),\n        showRadius = _React$useState8[0],\n        setShowRadius = _React$useState8[1];\n\n  const _React$useState9 = React.useState(\"\"),\n        _React$useState10 = _slicedToArray(_React$useState9, 2),\n        cloned = _React$useState10[0],\n        setCloned = _React$useState10[1];\n\n  const toogleShowRadius = () => {\n    setShowRadius(!showRadius);\n  };\n\n  const toogleIntruder = () => {\n    let newIntruder = clone(intruder);\n    newIntruder.status = !intruder.status;\n    setIntruder(newIntruder);\n  };\n\n  const toogleSimulationOptions = () => {\n    setShowSimulationOptions(!showSimulationOptions);\n  };\n\n  const buttonColor = () => {\n    return showSimulationOptions ? \"amber-text\" : \"grey-text\";\n  };\n\n  const updatePosition = target => {\n    let newTarget = {};\n\n    switch (target.direction % 4) {\n      case 0:\n        newTarget.lat = target.lat;\n        newTarget.lng = target.lng - 0.0001;\n        break;\n\n      case 1:\n        newTarget.lat = target.lat + 0.0001;\n        newTarget.lng = target.lng;\n        break;\n\n      case 2:\n        newTarget.lat = target.lat;\n        newTarget.lng = target.lng + 0.0001;\n        break;\n\n      case 3:\n        newTarget.lat = target.lat - 0.0001;\n        newTarget.lng = target.lng;\n        break;\n\n      default:\n        break;\n    }\n\n    newTarget = _objectSpread({}, newTarget, {}, stepCounter(target));\n    return newTarget;\n  };\n\n  const updatePatrolPosition = () => {\n    setPatrol(updatePosition(patrol));\n  }; // eslint-disable-next-line\n\n\n  const updateIntruderPosition = () => {\n    setIntruder(updatePosition(intruder));\n  };\n\n  const update = () => {\n    updatePatrolPosition();\n  };\n\n  const toRadians = degrees => {\n    var pi = Math.PI;\n    return degrees * (pi / 180);\n  };\n\n  const distance = (position1, position2) => {\n    var R = 6371e3; // metres\n\n    var lat1 = toRadians(position1.lat);\n    var lat2 = toRadians(position2.lat);\n    var latDiff = toRadians(position2.lat - position1.lat);\n    var lngDiff = toRadians(position2.lng - position1.lng);\n    var a = Math.sin(latDiff / 2) * Math.sin(latDiff / 2) + Math.cos(lat1) * Math.cos(lat2) * Math.sin(lngDiff / 2) * Math.sin(lngDiff / 2);\n    var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n    return R * c;\n  };\n\n  setTimeout(update, 1000);\n\n  const allSignals = () => {\n    let allSignals = clone(routers);\n    intruder.status && allSignals.push(intruder);\n    return allSignals;\n  };\n\n  const getRouterPosition = name => {\n    for (let key in routers) {\n      const router = routers[key];\n\n      if (router.name === name) {\n        return {\n          lat: router.lat,\n          lng: router.lng\n        };\n      }\n    }\n  };\n\n  const checkWifi = () => {\n    const signals = allSignals();\n\n    for (let key in signals) {\n      const listenNow = signals[key];\n      const signalPosition = {\n        lat: listenNow.lat,\n        lng: listenNow.lng\n      };\n      const routerPosition = getRouterPosition(listenNow.name);\n      let measuredDistance = distance(patrol, signalPosition);\n      let routerDistance = distance(patrol, routerPosition);\n\n      if (cloned === '' && measuredDistance < 30 && measuredDistance != routerDistance) {\n        setCloned(listenNow.name);\n      }\n    }\n  };\n\n  const display = () => {\n    return showSimulationOptions ? \"Show\" : \"Hide\";\n  };\n\n  checkWifi();\n  console.log(cloned);\n  return React.createElement(\"div\", {\n    className: \"App\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 177\n    },\n    __self: this\n  }, React.createElement(\"header\", {\n    className: \"App-header\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 178\n    },\n    __self: this\n  }, React.createElement(MDBIcon, {\n    icon: \"wifi\",\n    size: \"4x\",\n    className: \"amber-text\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 179\n    },\n    __self: this\n  }), React.createElement(MDBIcon, {\n    icon: \"bars\",\n    size: \"4x\",\n    className: buttonColor(),\n    onClick: () => toogleSimulationOptions(),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 180\n    },\n    __self: this\n  })), React.createElement(\"div\", {\n    className: \"Body\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 187\n    },\n    __self: this\n  }, React.createElement(RouterPanel, {\n    className: \"RouterPanel\",\n    routers: routers,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 188\n    },\n    __self: this\n  }), React.createElement(LeafletMap, {\n    center: center,\n    routers: routers,\n    patrol: patrol,\n    intruder: intruder,\n    showRadius: showRadius,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 189\n    },\n    __self: this\n  }), React.createElement(SimulationOptions, {\n    className: display(),\n    toogleShowRadius: toogleShowRadius,\n    toogleIntruder: toogleIntruder,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 196\n    },\n    __self: this\n  })));\n};\n\nexport default App;","map":{"version":3,"sources":["/home/caio/workspace/wp/src/compopnents/App.jsx"],"names":["React","LeafletMap","RouterPanel","SimulationOptions","MDBIcon","routers","clone","App","patrolInitialPosition","status","lat","lng","direction","step","intruderInitialPosition","name","center","stepCounter","target","patrolDirection","useState","showSimulationOptions","setShowSimulationOptions","patrol","setPatrol","intruder","setIntruder","showRadius","setShowRadius","cloned","setCloned","toogleShowRadius","toogleIntruder","newIntruder","toogleSimulationOptions","buttonColor","updatePosition","newTarget","updatePatrolPosition","updateIntruderPosition","update","toRadians","degrees","pi","Math","PI","distance","position1","position2","R","lat1","lat2","latDiff","lngDiff","a","sin","cos","c","atan2","sqrt","setTimeout","allSignals","push","getRouterPosition","key","router","checkWifi","signals","listenNow","signalPosition","routerPosition","measuredDistance","routerDistance","display","console","log"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport \"../styles/App.css\";\nimport LeafletMap from \"./LeafletMap\";\nimport RouterPanel from \"./RouterPanel\";\nimport SimulationOptions from \"./SimulationOptions\";\nimport { MDBIcon } from \"mdbreact\";\nimport routers from \"../routersList\";\nimport { clone } from \"../utils\";\n\nconst App = () => {\n  const patrolInitialPosition = {\n    status: true,\n    lat: 43.5387,\n    lng: -79.666,\n    direction: 0, //   0->east, 1->north, 2->weast, 3->south\n    step: 14\n  };\n  \n  const intruderInitialPosition = {\n    name: \"PDSB-ADMIN\",\n    status: false,\n    lat: 43.5392,\n    lng: -79.6675,\n    direction: 2, //   0->east, 1->north, 2->weast, 3->south\n    step: 14\n  };\n\n  const center = [43.53885796212106, -79.66675600122652];\n\n  const stepCounter = target => {\n    let stepCounter = target.step;\n    let patrolDirection = target.direction;\n    if (stepCounter > 0) {\n      stepCounter = stepCounter - 1;\n      return { step: stepCounter, direction: patrolDirection };\n    } else {\n      patrolDirection = patrolDirection + 1;\n      if (patrolDirection % 2 === 0) {\n        // Mississauga is way too North, I had to adjust\n        stepCounter = 14; // the step because lat!=lgn near the polos\n      } else {\n        stepCounter = 5; // Just 5 steps when walking on vertical.\n      }\n      return { step: stepCounter, direction: patrolDirection };\n    }\n  };\n\n  const [showSimulationOptions, setShowSimulationOptions] = React.useState(\n    true\n  );\n  const [patrol, setPatrol] = React.useState(patrolInitialPosition);\n  const [intruder, setIntruder] = React.useState(intruderInitialPosition);\n  const [showRadius, setShowRadius] = React.useState(false);\n  const [cloned, setCloned] = React.useState(\"\");\n\n  const toogleShowRadius = () => {\n    setShowRadius(!showRadius);\n  };\n\n  const toogleIntruder = () => {\n    let newIntruder = clone(intruder);\n    newIntruder.status = !intruder.status;\n    setIntruder(newIntruder);\n  };\n\n  const toogleSimulationOptions = () => {\n    setShowSimulationOptions(!showSimulationOptions);\n  };\n\n  const buttonColor = () => {\n    return showSimulationOptions ? \"amber-text\" : \"grey-text\";\n  };\n\n  const updatePosition = target => {\n    let newTarget = {};\n    switch (target.direction % 4) {\n      case 0:\n        newTarget.lat = target.lat;\n        newTarget.lng = target.lng - 0.0001;\n        break;\n      case 1:\n        newTarget.lat = target.lat + 0.0001;\n        newTarget.lng = target.lng;\n        break;\n      case 2:\n        newTarget.lat = target.lat;\n        newTarget.lng = target.lng + 0.0001;\n        break;\n      case 3:\n        newTarget.lat = target.lat - 0.0001;\n        newTarget.lng = target.lng;\n        break;\n      default:\n        break;\n    }\n    newTarget = { ...newTarget, ...stepCounter(target) };\n    return newTarget;\n  };\n\n  const updatePatrolPosition = () => {\n    setPatrol(updatePosition(patrol));\n  };\n\n  // eslint-disable-next-line\n  const updateIntruderPosition = () => {\n    setIntruder(updatePosition(intruder));\n  };\n\n  const update = () => {\n    updatePatrolPosition();\n  };\n\n  const toRadians = degrees => {\n    var pi = Math.PI;\n    return degrees * (pi / 180);\n  };\n\n  const distance = (position1, position2) => {\n    var R = 6371e3; // metres\n    var lat1 = toRadians(position1.lat);\n    var lat2 = toRadians(position2.lat);\n    var latDiff = toRadians(position2.lat - position1.lat);\n    var lngDiff = toRadians(position2.lng - position1.lng);\n    var a =\n      Math.sin(latDiff / 2) * Math.sin(latDiff / 2) +\n      Math.cos(lat1) *\n        Math.cos(lat2) *\n        Math.sin(lngDiff / 2) *\n        Math.sin(lngDiff / 2);\n    var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n\n    return R * c;\n  };\n\n  setTimeout(update, 1000);\n\n  const allSignals = () => {\n    let allSignals = clone(routers);\n    intruder.status && allSignals.push(intruder);\n    return allSignals;\n  };\n\n  const getRouterPosition = name => {\n    for (let key in routers) {\n      const router = routers[key];\n      if (router.name === name) {\n        return {\n          lat: router.lat,\n          lng: router.lng\n        };\n      }\n    }\n  };\n\n  const checkWifi = () => {\n    const signals = allSignals();\n    for (let key in signals) {\n      const listenNow = signals[key];\n      const signalPosition = { lat: listenNow.lat, lng: listenNow.lng };\n      const routerPosition = getRouterPosition(listenNow.name);\n      let measuredDistance = distance(patrol, signalPosition);\n      let routerDistance = distance(patrol, routerPosition);\n      if (cloned === '' && measuredDistance<30 && measuredDistance != routerDistance) {\n        setCloned(listenNow.name);\n      }\n    }\n  };\n\n  const display = () => {\n    return showSimulationOptions ? \"Show\" : \"Hide\";\n  };\n\n  checkWifi();\n  console.log(cloned);\n  \n  return (\n    <div className=\"App\">\n      <header className=\"App-header\">\n        <MDBIcon icon=\"wifi\" size=\"4x\" className=\"amber-text\" />\n        <MDBIcon\n          icon=\"bars\"\n          size=\"4x\"\n          className={buttonColor()}\n          onClick={() => toogleSimulationOptions()}\n        />\n      </header>\n      <div className=\"Body\">\n        <RouterPanel className=\"RouterPanel\" routers={routers} />\n        <LeafletMap\n          center={center}\n          routers={routers}\n          patrol={patrol}\n          intruder={intruder}\n          showRadius={showRadius}\n        />\n        <SimulationOptions\n          className={display()}\n          toogleShowRadius={toogleShowRadius}\n          toogleIntruder={toogleIntruder}\n        />\n      </div>\n    </div>\n  );\n};\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}